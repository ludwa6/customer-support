Based on your description and the code in server/services/openai.ts, here’s what might be happening:
What’s likely going on
Your code uses a function called getFAQs() (imported from ./notion) to fetch FAQ data from Notion.
The Notion database ID(s) used by getFAQs() are probably hardcoded or set via environment variables.
When you “share” the project or deploy it for a new user, unless you update the Notion database ID(s) (and possibly the Notion integration token) for that new user, the code will still try to access the original database(s).
Why this is a problem
Notion database IDs are unique per workspace/database. If a new user has their own Notion workspace, they’ll have different database IDs.
If your code doesn’t dynamically accept or update the database ID for each user, it will always pull from the original database, or fail if the ID/token is invalid for the new user.
Common causes
Hardcoded Database IDs:
The Notion database ID is hardcoded in your code or in a shared .env file.
Environment Variables Not Updated:
The environment variable (e.g., NOTION_DATABASE_ID) is not set or updated for each new user/environment.
No User Context:
Your backend doesn’t have a way to know which Notion database to use for each user (e.g., multi-tenancy is not implemented).
Notion Integration Token Issues:
The Notion integration token is not updated for each user, so the integration can’t access the new user’s database.
How to fix
Make database ID configurable per user:
Pass the Notion database ID (and token, if needed) as part of the user’s session, request, or configuration.
Update your getFAQs() function to accept a database ID as a parameter, rather than using a hardcoded value or a single environment variable.
Store user-specific configuration (database ID, token) in your database, and fetch it based on the current user.
Example (pseudo-code)
Apply to openai.ts
;
And update your getFAQs implementation accordingly.
Summary:
Your project is likely not set up to handle per-user Notion database IDs and tokens. You need to make these values dynamic and user-specific, rather than static or global.
If you want, I can help you refactor your code to support this! Just let me know how you’re currently storing or passing user-specific Notion credentials.